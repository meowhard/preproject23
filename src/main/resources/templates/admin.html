<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Users</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
              rel="stylesheet"
              integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65"
              crossorigin="anonymous">
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    </head>

    <script>
        $(document).ready(function () {
            $('#add-tab').click(function () {

                console.log("add-tab нажата");

                $('#usersTablePage').addClass('d-none');
                $('#addUserPage').removeClass('d-none');

                $('#users-tab').removeClass('active');
                $('#add-tab').addClass('active');


            });

            $('#users-tab').click(function () {

                console.log("users-tab нажата");

                $('#addUserPage').addClass('d-none');
                $('#usersTablePage').removeClass('d-none');

                $('#add-tab').removeClass('active');
                $('#users-tab').addClass('active');
            });
        });
    </script>

    <body class="bg-light">
        <div>
            <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
                <div class="container-fluid">
                    <div class="collapse navbar-collapse" id="navbarSupportedContent">
                        <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                            <li class="nav-item">
                                <a class="nav-link active" aria-current="page" th:text="${user.email}"></a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link disabled" tabindex="-1" aria-disabled="true" th:text="${user.getRolesToString()}"></a>
                            </li>
                        </ul>
                        <form class="d-grid gap-2 d-md-flex justify-content-md-end" role="search">
                            <a th:href="@{/logout}"
                               class="btn btn-outline-light" type="submit">Logout</a>
                        </form>
                    </div>
                </div>
            </nav>

            <div class="row vh-100">
                <div class="col-md-2 bg-white">
                    <button class="btn btn-primary h-auto w-100 rounded-0 text-start">Admin</button>
                    <button class="btn btn-link h-auto w-100 rounded-0 text-start">User</button>
                </div>

                <div class="col-md-8 ms-3 me-3 flex-fill">
                    <div class = "row">
                        <h1> Admin panel </h1>
                    </div>

                    <ul class="nav nav-tabs" id="myTab" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="users-tab" data-bs-toggle="tab" data-bs-target="#users" type="button" role="tab" aria-controls="users" aria-selected="true">Users table</button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="add-tab" data-bs-toggle="tab" data-bs-target="#add" type="button" role="tab" aria-controls="add" aria-selected="false">Add user</button>
                        </li>
                    </ul>

                    <div class="tab-content" id="usersTablePage">
                        <h5 class="mt-2 mx-2"> All users </h5>
                        <div class="tab-pane fade show active" id="users" role="tabpanel" aria-labelledby="users-tab">
                            <table class = "table table-striped table-bordered">
                                <thead class = "table-dark">
                                <tr>
                                    <th> Name </th>
                                    <th> Age </th>
                                    <th> Email </th>
                                    <th> Role </th>
                                    <th> Update </th>
                                    <th> Remove </th>
                                </tr>
                                </thead>

                                <tbody>
                                <tr th:each = "user: ${users}">
                                    <td th:text = "${user.name}"></td>
                                    <td th:text = "${user.age}"></td>
                                    <td th:text = "${user.email}"></td>
                                    <td th:text = "${user.getRolesToString()}"></td>
                                    <td>
                                        <a th:href="@{/admin/edit/{id}(id=${user.id})}"
                                           class="btn btn-success d-grid"> Edit </a>
                                    </td>
                                    <td>
                                        <a th:href="@{/admin/deleteUser/{id}(id=${user.id})}"
                                           class="btn btn-danger d-grid"> Delete </a>
                                    </td>

                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class = "card d-none" id="addUserPage">
                        <div class = "row">
                            <div class = "card w-100" >
                                <h1 class="text-center"> Create New User </h1>
                                <span class="card-body"></span>
                                <form th:action="@{/admin}" th:object="${user}" th:method="POST">
                                    <div class="form-group">
                                        <label> User Name </label>
                                        <input type="text" name="Name" th:field="*{name}" class="form-control" placeholder="Enter User Name"
                                        />
                                    </div>

                                    <div th:if="${usernameErr}">
                                        <div class="alert alert-danger" th:text="${usernameErr}"></div>
                                    </div>

                                    <div class="form-group">
                                        <label> User Password </label>
                                        <input
                                                type="text"
                                                name="Password"
                                                th:field="*{password}"
                                                class="form-control"
                                                placeholder="Enter User Password"
                                        />
                                    </div>

                                    <div class="form-group">
                                        <label> User Age </label>
                                        <input
                                                type="text"
                                                name="Age"
                                                th:field="*{age}"
                                                class="form-control"
                                                placeholder="Enter User Age"
                                        />
                                    </div>

                                    <div class="form-group">
                                        <label> User Email </label>
                                        <input
                                                type="text"
                                                name="Email"
                                                th:field="*{email}"
                                                class="form-control"
                                                placeholder="Enter User Email"
                                        />
                                    </div>

                                    <div class="box-footer">
                                        <button type="submit" class="btn btn-primary">
                                            Submit
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>